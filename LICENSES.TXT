
MIT License

Copyright (c) Tailwind Labs, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.




<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
  <path fill-rule="evenodd" d="M9.293 2.293a1 1 0 0 1 1.414 0l7 7A1 1 0 0 1 17 11h-1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6H3a1 1 0 0 1-.707-1.707l7-7Z" clip-rule="evenodd" />
</svg>

















// src/app/_components/ReviewsCarousel.tsx
"use client";

import React, { useEffect, useMemo, useRef, useState } from "react";

type Review = {
  name: string;
  text: string;
  rating?: 1 | 2 | 3 | 4 | 5;
  meta?: string; // ej: "Cliente habitual" / "Hace 2 semanas"
};

function Star({ filled }: { filled: boolean }) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 16 16"
      fill="currentColor"
      className={`size-4 ${filled ? "text-logo-100" : "text-logo-100/25"}`}
      aria-hidden="true"
    >
      <path
        fillRule="evenodd"
        d="M8 1.75a.75.75 0 0 1 .692.462l1.41 3.393 3.664.293a.75.75 0 0 1 .428 1.317l-2.791 2.39.853 3.575a.75.75 0 0 1-1.12.814L7.998 12.08l-3.135 1.915a.75.75 0 0 1-1.12-.814l.852-3.574-2.79-2.39a.75.75 0 0 1 .427-1.318l3.663-.293 1.41-3.393A.75.75 0 0 1 8 1.75Z"
        clipRule="evenodd"
      />
    </svg>
  );
}

function ReviewCard({ review }: { review: Review }) {
  const rating = review.rating ?? 5;
  const initials = useMemo(() => {
    const parts = review.name.trim().split(/\s+/);
    return (parts[0]?.[0] ?? "R") + (parts[1]?.[0] ?? "");
  }, [review.name]);

  return (
    <article
      className="
        relative h-full w-full
        rounded-2xl bg-fondo-500/90
        border border-white/10
        shadow-[0_10px_30px_rgba(0,0,0,0.35)]
        p-5 sm:p-6
      "
    >
      {/* Barra superior */}
      <div className="flex items-center justify-between gap-3">
        <div className="flex items-center gap-1" aria-label={`${rating} de 5`}>
          {Array.from({ length: 5 }).map((_, i) => (
            <Star key={i} filled={i < rating} />
          ))}
        </div>

        {/* avatar simple */}
        <div className="grid size-10 place-items-center rounded-full bg-enfasis-800/40 border border-white/10">
          <span className="font-title text-sm text-white/90">{initials}</span>
        </div>
      </div>

      {/* Texto */}
      <p className="mt-4 font-title text-base sm:text-[17px] leading-relaxed text-white/85">
        <span className="text-logo-100/90">“</span>
        {review.text}
        <span className="text-logo-100/90">”</span>
      </p>

      {/* Footer */}
      <footer className="mt-5 flex items-end justify-between gap-4">
        <div className="flex flex-col">
          <p className="font-title text-lg text-white">{review.name}</p>
          {review.meta ? (
            <p className="text-sm text-white/50">{review.meta}</p>
          ) : null}
        </div>

        <svg
          className="size-8 text-logo-100/25"
          viewBox="0 0 24 24"
          fill="currentColor"
          aria-hidden="true"
        >
          <path d="M7.2 10.8c-1.6 0-2.9-1.3-2.9-2.9S5.6 5 7.2 5s2.9 1.3 2.9 2.9c0 2.8-1.8 5.8-4.4 7.5-.3.2-.7.1-.9-.2-.2-.3-.1-.7.2-.9 1.8-1.2 3.2-3.2 3.6-5.1-.4.3-.9.5-1.4.5zM17.2 10.8c-1.6 0-2.9-1.3-2.9-2.9S15.6 5 17.2 5s2.9 1.3 2.9 2.9c0 2.8-1.8 5.8-4.4 7.5-.3.2-.7.1-.9-.2-.2-.3-.1-.7.2-.9 1.8-1.2 3.2-3.2 3.6-5.1-.4.3-.9.5-1.4.5z" />
        </svg>
      </footer>
    </article>
  );
}

export default function ReviewsCarousel({
  reviews,
  title = "Reseñas",
  subtitle = "La gente sale impecable. Y lo dice.",
}: {
  reviews: Review[];
  title?: string;
  subtitle?: string;
}) {
  const trackRef = useRef<HTMLDivElement | null>(null);
  const [canPrev, setCanPrev] = useState(false);
  const [canNext, setCanNext] = useState(true);

  const updateButtons = () => {
    const el = trackRef.current;
    if (!el) return;
    const maxScrollLeft = el.scrollWidth - el.clientWidth;
    setCanPrev(el.scrollLeft > 5);
    setCanNext(el.scrollLeft < maxScrollLeft - 5);
  };

  useEffect(() => {
    updateButtons();
    const el = trackRef.current;
    if (!el) return;

    const onScroll = () => requestAnimationFrame(updateButtons);
    el.addEventListener("scroll", onScroll, { passive: true });

    const onResize = () => updateButtons();
    window.addEventListener("resize", onResize);

    return () => {
      el.removeEventListener("scroll", onScroll);
      window.removeEventListener("resize", onResize);
    };
  }, []);

  const scrollByViewport = (dir: -1 | 1) => {
    const el = trackRef.current;
    if (!el) return;
    const amount = Math.round(el.clientWidth * 0.9);
    el.scrollBy({ left: dir * amount, behavior: "smooth" });
  };

  return (
    <section className="section py-10">
      <div className="section-inner">
        <div className="flex items-end justify-between gap-4">
          <div className="space-y-1">
            <h2 className="font-title text-2xl sm:text-3xl text-white">{title}</h2>
            <p className="text-white/60">{subtitle}</p>
          </div>

          <div className="hidden sm:flex items-center gap-2">
            <button
              type="button"
              onClick={() => scrollByViewport(-1)}
              disabled={!canPrev}
              className="
                rounded-full px-4 py-2
                border border-white/10
                bg-enfasis-800/40 text-white/80
                hover:bg-enfasis-800/60
                disabled:opacity-40 disabled:cursor-not-allowed
                transition
              "
              aria-label="Anterior"
            >
              ←
            </button>
            <button
              type="button"
              onClick={() => scrollByViewport(1)}
              disabled={!canNext}
              className="
                rounded-full px-4 py-2
                border border-white/10
                bg-enfasis-800/40 text-white/80
                hover:bg-enfasis-800/60
                disabled:opacity-40 disabled:cursor-not-allowed
                transition
              "
              aria-label="Siguiente"
            >
              →
            </button>
          </div>
        </div>

        {/* Carril */}
        <div className="relative mt-6">
          {/* fades laterales (toque premium) */}
          <div className="pointer-events-none absolute inset-y-0 left-0 w-10 bg-gradient-to-r from-enfasis-800 to-transparent" />
          <div className="pointer-events-none absolute inset-y-0 right-0 w-10 bg-gradient-to-l from-enfasis-800 to-transparent" />

          <div
            ref={trackRef}
            className="
              flex gap-4
              overflow-x-auto scroll-smooth
              snap-x snap-mandatory
              pb-2
              [-ms-overflow-style:none] [scrollbar-width:none]
              [&::-webkit-scrollbar]:hidden
            "
          >
            {reviews.map((r, idx) => (
              <div
                key={`${r.name}-${idx}`}
                className="
                  snap-start
                  shrink-0
                  w-[85%] sm:w-[60%] md:w-[48%] lg:w-[32%]
                "
              >
                <ReviewCard review={r} />
              </div>
            ))}
          </div>

          {/* Botones móvil (abajo) */}
          <div className="mt-4 flex sm:hidden items-center justify-center gap-2">
            <button
              type="button"
              onClick={() => scrollByViewport(-1)}
              disabled={!canPrev}
              className="
                 px-4 py-2
                border border-white/10
                bg-enfasis-800/40 text-white/80
                disabled:opacity-40 disabled:cursor-not-allowed
              "
            >
              ←
            </button>
            <button
              type="button"
              onClick={() => scrollByViewport(1)}
              disabled={!canNext}
              className="
                 px-4 py-2
                border border-white/10
                bg-enfasis-800/40 text-white/80
                disabled:opacity-40 disabled:cursor-not-allowed
              "
            >
              →
            </button>
          </div>
        </div>
      </div>
    </section>
  );
}
































































































// src/app/_components/ReviewsCarousel.tsx
"use client";

import React, { useEffect, useMemo, useRef, useState } from "react";

type Review = {
  name: string;
  text: string;
  rating?: 1 | 2 | 3 | 4 | 5;
  meta?: string;
};

function Star({ filled }: { filled: boolean }) {
  return (
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 16 16"
      fill="currentColor"
      className={`size-4 ${filled ? "text-logo-100" : "text-logo-100/25"}`}
      aria-hidden="true"
    >
      <path
        fillRule="evenodd"
        d="M8 1.75a.75.75 0 0 1 .692.462l1.41 3.393 3.664.293a.75.75 0 0 1 .428 1.317l-2.791 2.39.853 3.575a.75.75 0 0 1-1.12.814L7.998 12.08l-3.135 1.915a.75.75 0 0 1-1.12-.814l.852-3.574-2.79-2.39a.75.75 0 0 1 .427-1.318l3.663-.293 1.41-3.393A.75.75 0 0 1 8 1.75Z"
        clipRule="evenodd"
      />
    </svg>
  );
}

function ReviewCard({ review }: { review: Review }) {
  const rating = review.rating ?? 5;

  const initials = useMemo(() => {
    const parts = review.name.trim().split(/\s+/);
    return (parts[0]?.[0] ?? "R") + (parts[1]?.[0] ?? "");
  }, [review.name]);

  return (
    <article
      className="
        h-full w-full
        rounded-2xl
        border border-white/10
        bg-white/5
        backdrop-blur
        shadow-[0_12px_40px_rgba(0,0,0,0.35)]
        p-5 sm:p-6
      "
    >
      <div className="flex items-center justify-between gap-3">
        <div className="flex items-center gap-1" aria-label={`${rating} de 5`}>
          {Array.from({ length: 5 }).map((_, i) => (
            <Star key={i} filled={i < rating} />
          ))}
        </div>

        <div className="grid size-10 place-items-center rounded-full bg-white/5 border border-white/10">
          <span className="font-title text-sm text-white/90">{initials}</span>
        </div>
      </div>

      <p className="mt-4 font-title text-base sm:text-[17px] leading-relaxed text-white/85">
        <span className="text-logo-100/90">“</span>
        {review.text}
        <span className="text-logo-100/90">”</span>
      </p>

      <footer className="mt-5 flex items-end justify-between gap-4">
        <div className="flex flex-col">
          <p className="font-title text-lg text-white">{review.name}</p>
          {review.meta ? <p className="text-sm text-white/50">{review.meta}</p> : null}
        </div>

        <svg className="size-8 text-logo-100/25" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M7.2 10.8c-1.6 0-2.9-1.3-2.9-2.9S5.6 5 7.2 5s2.9 1.3 2.9 2.9c0 2.8-1.8 5.8-4.4 7.5-.3.2-.7.1-.9-.2-.2-.3-.1-.7.2-.9 1.8-1.2 3.2-3.2 3.6-5.1-.4.3-.9.5-1.4.5zM17.2 10.8c-1.6 0-2.9-1.3-2.9-2.9S15.6 5 17.2 5s2.9 1.3 2.9 2.9c0 2.8-1.8 5.8-4.4 7.5-.3.2-.7.1-.9-.2-.2-.3-.1-.7.2-.9 1.8-1.2 3.2-3.2 3.6-5.1-.4.3-.9.5-1.4.5z" />
        </svg>
      </footer>
    </article>
  );
}

export default function ReviewsCarousel({
  reviews,
  title = "Reseñas",
  subtitle = "Se nota el detalle. Y lo dicen.",
  autoPlayMs = 4500,
}: {
  reviews: Review[];
  title?: string;
  subtitle?: string;
  autoPlayMs?: number;
}) {
  const trackRef = useRef<HTMLDivElement | null>(null);
  const itemRefs = useRef<(HTMLDivElement | null)[]>([]);
  const [activeIndex, setActiveIndex] = useState(0);
  const [paused, setPaused] = useState(false);

  const scrollToIndex = (idx: number) => {
    const el = itemRefs.current[idx];
    el?.scrollIntoView({ behavior: "smooth", inline: "center", block: "nearest" });
  };

  // Detecta el slide activo con IntersectionObserver (robusto con scroll-snap)
  useEffect(() => {
    const track = trackRef.current;
    if (!track) return;

    const io = new IntersectionObserver(
      (entries) => {
        // coge el más visible dentro del carril
        let best = { idx: activeIndex, ratio: 0 };
        for (const e of entries) {
          const idx = Number((e.target as HTMLElement).dataset.idx ?? "0");
          if (e.isIntersecting && e.intersectionRatio > best.ratio) {
            best = { idx, ratio: e.intersectionRatio };
          }
        }
        if (best.ratio > 0) setActiveIndex(best.idx);
      },
      { root: track, threshold: [0.5, 0.6, 0.7, 0.8] }
    );

    itemRefs.current.forEach((node) => node && io.observe(node));
    return () => io.disconnect();
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [reviews.length]);

  // Autoplay + pausa por hover/touch + pausa si la pestaña no está visible
  useEffect(() => {
    if (paused) return;
    if (reviews.length <= 1) return;

    let t: number | null = null;

    const tick = () => {
      const next = (activeIndex + 1) % reviews.length;
      scrollToIndex(next);
      t = window.setTimeout(tick, autoPlayMs);
    };

    t = window.setTimeout(tick, autoPlayMs);

    const onVis = () => {
      if (document.hidden) setPaused(true);
    };
    document.addEventListener("visibilitychange", onVis);

    return () => {
      if (t) window.clearTimeout(t);
      document.removeEventListener("visibilitychange", onVis);
    };
  }, [activeIndex, autoPlayMs, paused, reviews.length]);

  const pause = () => setPaused(true);
  const resume = () => setPaused(false);

  return (
    <section className="section py-10 bg-[var(--background)]">
      <div className="section-inner">
        <div className="flex items-end justify-between gap-4">
          <div className="space-y-1">
            <h2 className="font-title text-2xl sm:text-3xl text-white">{title}</h2>
            <p className="text-white/60">{subtitle}</p>
          </div>

          {/* Dots */}
          <div className="hidden sm:flex items-center gap-2">
            {reviews.map((_, i) => (
              <button
                key={i}
                type="button"
                onClick={() => scrollToIndex(i)}
                className={`
                  size-2.5 rounded-full transition
                  ${i === activeIndex ? "bg-logo-100" : "bg-white/15 hover:bg-white/30"}
                `}
                aria-label={`Ir a reseña ${i + 1}`}
              />
            ))}
          </div>
        </div>

        <div className="relative mt-6">
          {/* Fades laterales para “premium” + fondo del body */}
          <div className="pointer-events-none absolute inset-y-0 left-0 w-10 bg-gradient-to-r from-[var(--background)] to-transparent z-10" />
          <div className="pointer-events-none absolute inset-y-0 right-0 w-10 bg-gradient-to-l from-[var(--background)] to-transparent z-10" />

          <div
            ref={trackRef}
            // Pausa: hover (desktop) + tocar/arrastrar (móvil)
            onMouseEnter={pause}
            onMouseLeave={resume}
            onPointerDown={pause}
            onPointerUp={resume}
            onPointerCancel={resume}
            className="
              flex gap-4
              overflow-x-auto scroll-smooth
              snap-x snap-mandatory
              px-[7vw] sm:px-[10vw]  /* <- clave: centra y deja peek */
              pb-2
              [-ms-overflow-style:none] [scrollbar-width:none]
              [&::-webkit-scrollbar]:hidden
            "
            style={{
              // mejora el centrado del snap con padding
              scrollPaddingLeft: "10vw",
              scrollPaddingRight: "10vw",
            }}
          >
            {reviews.map((r, idx) => (
              <div
                key={`${r.name}-${idx}`}
                data-idx={idx}
                ref={(node) => {
                  itemRefs.current[idx] = node;
                }}
                className="
                  snap-center
                  shrink-0
                  w-[86%] sm:w-[72%] md:w-[56%] lg:w-[44%]  /* <- 1 tarjeta + peek */
                "
              >
                <ReviewCard review={r} />
              </div>
            ))}
          </div>

          {/* Dots móvil */}
          <div className="mt-4 flex sm:hidden items-center justify-center gap-2">
            {reviews.map((_, i) => (
              <button
                key={i}
                type="button"
                onClick={() => scrollToIndex(i)}
                className={`
                  h-2 rounded-full transition
                  ${i === activeIndex ? "w-6 bg-logo-100" : "w-2 bg-white/15"}
                `}
                aria-label={`Ir a reseña ${i + 1}`}
              />
            ))}
          </div>
          
        </div>
      </div>
    </section>
  );
}

